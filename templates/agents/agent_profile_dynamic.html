{% extends 'base.html' %}

{% load static %}
{% load humanize %}

{% block title %}{{ agent.user.get_full_name|default:agent.user.username }} - Agent Profile | Nestova{% endblock %}

{% block content %}

<main class="main">

    <!-- Page Title -->
    <div class="page-title">
        <div class="heading">
            <div class="container">
                <div class="row d-flex justify-content-center text-center">
                    <div class="col-lg-8">
                        <h1 class="heading-title">Agent Profile</h1>
                        <p class="mb-0">
                            View properties and connect with our verified real estate professional
                        </p>
                    </div>
                </div>
            </div>
        </div>
        <nav class="breadcrumbs">
            <div class="container">
                <ol>
                    <li><a href="{% url 'home' %}">Home</a></li>
                    <li><a href="{% url 'home' %}#featured-agents">Agents</a></li>
                    <li class="current">{{ agent.user.get_full_name|default:agent.user.username }}</li>
                </ol>
            </div>
        </nav>
    </div><!-- End Page Title -->

    <!-- Agent Profile Section -->
    <section id="agent-profile" class="agent-profile section">

        <div class="container" data-aos="fade-up" data-aos-delay="100">

            <!-- Agent Profile Card -->
            <div class="agent-profile-card" data-aos="zoom-in" data-aos-delay="150">
                <div class="profile-background">
                    <img src="{% static 'assets/img/real-estate/property-exterior-4.webp' %}" alt="Background"
                        class="profile-bg-image">
                </div>

                <div class="profile-content">
                    <div class="agent-avatar">
                        <img src="{% if agent.user.profile_image %}{{ agent.user.profile_image.url }}{% else %}{% static 'assets/img/real-estate/agent-3.webp' %}{% endif %}"
                            alt="{{ agent.user.get_full_name }}" class="avatar-image">
                        <div class="status-indicator">
                            <i class="bi bi-circle-fill"></i>
                            <span>{% if agent.is_active %}Available{% else %}Offline{% endif %}</span>
                        </div>
                    </div>

                    <div class="agent-header">
                        <h1 class="agent-name">{{ agent.user.get_full_name|default:agent.user.username }}</h1>
                        <div class="agent-credentials">
                            <span class="title">Licensed Real Estate Professional</span>
                            {% if agent.verification_status == 'verified' %}
                            <div class="verification-badge">
                                <i class="bi bi-patch-check-fill"></i>
                                <span>Verified Agent</span>
                            </div>
                            {% endif %}
                        </div>

                        <div class="quick-stats">
                            <div class="quick-stat">
                                <span class="stat-value">{{ total_properties }}</span>
                                <span class="stat-label">Properties Listed</span>
                            </div>
                            <div class="quick-stat">
                                <span class="stat-value">{{ agent.commission_rate }}%</span>
                                <span class="stat-label">Commission Rate</span>
                            </div>
                            <div class="quick-stat">
                                <span class="stat-value">{{ agent.created|date:"Y" }}</span>
                                <span class="stat-label">Member Since</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Main Content Grid -->
            <div class="main-content-grid" data-aos="fade-up" data-aos-delay="200">

                <!-- Left Content -->
                <div class="content-main">

                    <!-- Recent Properties -->
                    <div class="recent-properties-section">
                        <div class="d-flex justify-content-between align-items-center mb-4">
                            <h3>Recent Properties</h3>
                            {% if total_properties > 6 %}
                            <a href="{% url 'agents:agent_properties' agent.slug %}" class="btn btn-primary">View All {{
                                total_properties }} Properties</a>
                            {% endif %}
                        </div>

                        {% if recent_properties %}
                        <div class="row gy-4">
                            {% for property in recent_properties %}
                            <div class="col-lg-6" data-aos="fade-up" data-aos-delay="{% cycle '300' '350' '400' %}">
                                <article class="stack-card">
                                    <figure class="stack-media">
                                        <a href="{{ property.get_absolute_url }}">
                                            <img src="{% if property.featured_image %}{{ property.featured_image.url }}{% else %}{% static 'assets/img/real-estate/property-exterior-8.webp' %}{% endif %}"
                                                alt="{{ property.title }}" class="img-fluid" loading="lazy">
                                        </a>
                                        <figcaption>
                                            {% if property.is_exclusive %}
                                            <span class="chip exclusive">Exclusive</span>
                                            {% elif property.is_hot %}
                                            <span class="chip hot">Hot</span>
                                            {% elif property.is_new %}
                                            <span class="chip new">New</span>
                                            {% elif property.is_premium %}
                                            <span class="chip premium">Premium</span>
                                            {% endif %}
                                        </figcaption>
                                    </figure>
                                    <div class="stack-body">
                                        <h5><a href="{{ property.get_absolute_url }}">{{ property.title|truncatewords:5 }}</a></h5>
                                        <div class="stack-loc"><i class="bi bi-geo-alt"></i> {{ property.city.name }},
                                            {{ property.state.code }}</div>
                                        <ul class="stack-specs">
                                            <li><i class="bi bi-door-open"></i> {{ property.bedrooms }}</li>
                                            <li><i class="bi bi-droplet"></i> {{ property.bathrooms }}</li>
                                            <li><i class="bi bi-aspect-ratio"></i> {{ property.square_feet|floatformat:0|intcomma }} sq ft</li>
                                        </ul>
                                        <div class="stack-foot">
                                            <span class="stack-price">{{ property.formatted_price }}</span>
                                            <a href="{{ property.get_absolute_url }}" class="stack-link">View</a>
                                        </div>
                                    </div>
                                </article>
                            </div>
                            {% endfor %}
                        </div>
                        {% else %}
                        <div class="text-center py-5">
                            <p class="text-muted">No properties listed yet.</p>
                        </div>
                        {% endif %}
                    </div>

                </div>

                <!-- Right Sidebar -->
                <div class="content-sidebar">

                    <!-- Contact Widget -->
                    <div class="contact-widget">
                        <h4>Let's Connect</h4>

                        <div class="contact-methods">
                            {% if agent.user.phone %}
                            <a href="tel:{{ agent.user.phone }}" class="contact-method primary">
                                <i class="bi bi-telephone-fill"></i>
                                <div>
                                    <span class="method-label">Call Now</span>
                                    <span class="method-value">{{ agent.user.phone }}</span>
                                </div>
                            </a>
                            {% endif %}

                            <a href="mailto:{{ agent.user.email }}" class="contact-method">
                                <i class="bi bi-envelope-fill"></i>
                                <div>
                                    <span class="method-label">Email</span>
                                    <span class="method-value">{{ agent.user.email }}</span>
                                </div>
                            </a>
                        </div>

                        <div class="social-connect">
                            <h5>Follow Me</h5>
                            <div class="social-links">
                                {% if agent.linkedin_page %}<a href="{{ agent.linkedin_page }}" target="_blank"
                                    rel="noopener"><i class="bi bi-linkedin"></i></a>{% endif %}
                                {% if agent.instagram_page %}<a href="{{ agent.instagram_page }}" target="_blank"
                                    rel="noopener"><i class="bi bi-instagram"></i></a>{% endif %}
                                {% if agent.facebook_page %}<a href="{{ agent.facebook_page }}" target="_blank"
                                    rel="noopener"><i class="bi bi-facebook"></i></a>{% endif %}
                                {% if agent.x_page %}<a href="{{ agent.x_page }}" target="_blank" rel="noopener"><i
                                        class="bi bi-twitter-x"></i></a>{% endif %}
                            </div>
                        </div>
                    </div>

                    <!-- Agent Stats -->
                    <div class="achievements-widget">
                        <h4>Agent Statistics</h4>
                        <div class="achievement-list">
                            <div class="achievement-item">
                                <div class="achievement-icon">
                                    <i class="bi bi-house-door-fill"></i>
                                </div>
                                <div class="achievement-text">
                                    <h6>{{ total_properties }} Properties</h6>
                                    <span>Currently Listed</span>
                                </div>
                            </div>

                            <div class="achievement-item">
                                <div class="achievement-icon">
                                    <i class="bi bi-calendar-check"></i>
                                </div>
                                <div class="achievement-text">
                                    <h6>Member Since</h6>
                                    <span>{{ agent.created|date:"F Y" }}</span>
                                </div>
                            </div>

                            {% if agent.verification_status == 'verified' %}
                            <div class="achievement-item">
                                <div class="achievement-icon">
                                    <i class="bi bi-patch-check-fill"></i>
                                </div>
                                <div class="achievement-text">
                                    <h6>Verified Agent</h6>
                                    <span>Identity Confirmed</span>
                                </div>
                            </div>
                            {% endif %}
                        </div>
                    </div>

                </div>
            </div>

        </div>

    </section><!-- /Agent Profile Section -->

</main>

{% endblock content %}